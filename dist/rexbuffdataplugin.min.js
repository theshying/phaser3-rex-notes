!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?module.exports=e():"function"==typeof define&&define.amd?define(e):(t="undefined"!=typeof globalThis?globalThis:t||self).rexbuffdataplugin=e()}(void 0,function(){function s(t){return(s="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function u(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function i(t,e){for(var n=0;n<e.length;n++){var s=e[n];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(t,s.key,s)}}function r(t,e,n){return e&&i(t.prototype,e),n&&i(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t}function t(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&n(t,e)}function o(t){return(o=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function n(t,e){return(n=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t})(t,e)}function f(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function a(n){var s=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}();return function(){var t,e=o(n),e=(t=s?(t=o(this).constructor,Reflect.construct(e,arguments,t)):e.apply(this,arguments),this);if(t&&("object"==typeof t||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return f(e)}}function h(t){return void 0===t.buffs&&(t.baseValues={},t.buffs={},t.bounds={}),void 0===t.addBuff&&Object.assign(t,e),t}var c=function(){function t(){u(this,t),this.buffs={}}return r(t,[{key:"setEnable",value:function(t,e){return void 0===e&&(e=!0),this.buffs.hasOwnProperty(t)||(this.buffs[t]={enable:!0,value:0,type:l}),this.buffs[t].enable=e,this}},{key:"set",value:function(t,e){this.setEnable(t);var n=s(e),t=("number"===n?n=l:"string"===n&&(e=-1!==e.indexOf("%")?(n=b,parseFloat(e)/100):(n=l,parseFloat(e))),this.buffs[t]);return t.value=e,t.type=n,this}},{key:"remove",value:function(t){return this.buffs.hasOwnProperty(t)&&delete this.buffs[t],this}},{key:"buff",value:function(t){var e,n,s,i=t,u=this.buffs;for(s in u)if((e=u[s]).enable)switch(n=e.type,e=e.value,n){case l:i+=e;break;case b:i+=t*e}return i}}]),t}(),l=0,b=1,y=Phaser.Utils.Objects.IsPlainObject,p=Phaser.Utils.Objects.GetValue,d=function(){function s(t,e){var n;u(this,s),y(t)&&(t=p(n=t,"min",void 0),e=p(n,"max",void 0)),this.setMin(t),this.setMax(e)}return r(s,[{key:"setMin",value:function(t){return this.min=t,this}},{key:"setMax",value:function(t){return this.max=t,this}},{key:"clamp",value:function(t){return void 0!==this.min&&t<this.min?t=this.min:void 0!==this.max&&t>this.max&&(t=this.max),t}}]),s}(),e={setBaseValue:function(t,e){return this.baseValues[t]=e,this.set(t,this.getBuffResult(t)),this},removeBaseValue:function(t){return this.baseValues.hasOwnProperty(t)&&(delete this.baseValues[t],this.remove(t)),this},setBuff:function(t,e,n){return this.buffs.hasOwnProperty(t)||(this.buffs[t]=new c),this.buffs[t].set(e,n),this.set(t,this.getBuffResult(t)),this},enableBuff:function(t,e,n){return this.buffs.hasOwnProperty(t)||(this.buffs[t]=new c),this.buffs[t].setEnable(e,n),this.set(t,this.getBuffResult(t)),this},removeBuff:function(t,e){return this.buffs.hasOwnProperty(t)&&(void 0===e?delete this.buffs[t]:this.buffs[t].remove(e)),this.set(t,this.getBuffResult(t)),this},setMin:function(t,e){return this.bounds.hasOwnProperty(t)||(this.bounds[t]=new d),this.bounds[t].setMin(e),this.set(t,this.getBuffResult(t)),this},setMax:function(t,e){return this.bounds.hasOwnProperty(t)||(this.bounds[t]=new d),this.bounds[t].setMax(e),this.set(t,this.getBuffResult(t)),this},setBounds:function(t,e,n){return this.bounds.hasOwnProperty(t)||(this.bounds[t]=new d),this.bounds[t].setMin(e).setMax(n),this.set(t,this.getBuffResult(t)),this},getBuffResult:function(t){return this.clamp(t,this.buff(t))},buff:function(t,e){return void 0===e&&(e=this.getBaseValue(t)),this.buffs.hasOwnProperty(t)?this.buffs[t].buff(e):e},clamp:function(t,e){return void 0===e&&(e=this.list[t]),this.bounds.hasOwnProperty(t)?this.bounds[t].clamp(e):e},getBaseValue:function(t){return this.baseValues.hasOwnProperty(t)||(this.baseValues[t]=0),this.baseValues[t]},getBuffs:function(t,e){t=this.buffs[t];return void 0===e?t:t&&t.hasOwnProperty(e)?t[e]:void 0},getBuffValue:function(t,e){return this.getBuffs(t,e).value},getBounds:function(t){return this.bounds.hasOwnProperty(t)||(this.bounds[t]=new d),this.bounds[t]},getMinBound:function(t){return this.getBounds(t).min},getMaxBound:function(t){return this.getBounds(t).max}},v=Phaser.Data.DataManager,m=Phaser.Events.EventEmitter,w=function(){t(i,v);var s=a(i);function i(t,e){u(this,i);var n=void 0===e;return n&&(e=new m),e=s.call(this,t,e),n&&(n=t.events||t)&&n.once("destroy",e.destroy,f(e)),h(f(e)),e}return r(i)}();return Object.assign(w.prototype,e),function(){t(n,Phaser.Plugins.BasePlugin);var e=a(n);function n(t){return u(this,n),e.call(this,t)}return r(n,[{key:"start",value:function(){this.game.events.on("destroy",this.destroy,this)}},{key:"add",value:function(t,e){return new w(t,e)}},{key:"extend",value:h}]),n}()});
